<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
</head>
<body>

<script type="text/html">
let addWages = ()=>{
    return new Promise((resolve, reject) => {
        setTimeout(function  ()  {
            // 公司账户余额
            let  currentMoney = 9999999999;
            // 公司账户余额 > 100w
            if (currentMoney > 1000000) {
                resolve('同意加薪');
            } else {
                resolve('不同意加薪');
            }
        }, 2000)
    })
};
addWages().then(data => {
    console.log(data);
}, data => {
    console.log(data);
});
</script>
<script type="text/html">
let addWages = ()=>{
    return new Promise((resolve, reject) => {
        throw new Error('你表现不够优秀！');
    })
};
addWages().then(data => {
    console.log(data);
}, data => {
    console.log('这里输出：' + data);
});
</script>
<script type="text/html">
/* a.txt -> b.txt -> c.txt -> 输出内容*/
let fs = require('fs');
let readFiles = ()=>{
    fs.readFile('./a.txt','utf8', (err,data)=>{
        if(err) return console.log(err);
        fs.readFile(data,'utf8',function(err,data){
            if(err) return console.log(err);
            fs.readFile(data,'utf8',function(err,data){
                if(err) return console.log(err);
                console.log(data);
            })
        })
    })
};

/*
  调用输出结果：
  喜欢IT, 就上撩课(itlike.com)
*/
readFiles();
</script>
<script type="text/html">
let fs = require('fs');
// 1. 初始化promise
let readFile =(filePath)=>{
    return new Promise((resolve,reject)=>{
        fs.readFile(filePath,'utf8',(err,data)=>{
            if(err) return reject(err);
            resolve(data);
        })
    })
};
// 2. 类似于链式的调用方式
readFile('./a.txt').then((data)=>{
    return readFile(data);
}).then((data)=>{
    // 获取b.txt中内容
    return readFile(data);
}).then((data)=>{
    // 获取c.txt中内容
    console.log(data)
}).catch((err)=>{
    console.log(err)
});
</script>
<script>

let fs = require('fs');
// 1. 统一输出所有异步产生的结果
let allContent = {};
let logAllContent = (key,data)=>{
    allContent[key] = data;
    if(Object.keys(allContent).length === 2){
        console.log(allContent)
    }
};

// 2. 分别异步读取文件中的内容
fs.readFile('./a.txt', 'utf8', function (err, data) {
    if (err) return console.log(err);
    logAllContent(data);
});
fs.readFile('./b.txt', 'utf8', function (err, data) {
    if (err) return console.log(err);
    logAllContent(data);
});

</script>
<script>
let fs = require('fs');
let readFiles = (filePath)=>{
    return new Promise(function(resolve,reject){
        fs.readFile(filePath,'utf8', (err,data)=>{
            if(err) return reject(err);
            resolve(data);
        })
    })
};
Promise.all(
    [readFiles('./a.txt'),
     readFiles('./b.txt')]
).then(([data])=>{
    console.log({data})
});
// 不管两个promise谁先完成，Promise.all 方法会按照数组里面的顺序将结果返回
</script>
</body>
</html>